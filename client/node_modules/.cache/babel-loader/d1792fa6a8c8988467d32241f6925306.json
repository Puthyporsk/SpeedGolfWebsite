{"ast":null,"code":"import _defineProperty from\"/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import CreateEditAccountDialog from'./CreateEditAccountDialog.js';import ResetPasswordDialog from'./ResetPasswordDialog.js';import LookUpAccountDialog from'./LookUpAccountDialog.js';import SecurityQuestionDialog from'./SecurityQuestionDialog.js';var LoginPage=/*#__PURE__*/function(_React$Component){_inherits(LoginPage,_React$Component);function LoginPage(){var _this;_classCallCheck(this,LoginPage);_this=_possibleConstructorReturn(this,_getPrototypeOf(LoginPage).call(this));//Create a ref for the email input DOM element\n_this.handleLoginSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var url,res,resText;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_this.setState({loginBtnIcon:\"fa fa-spin fa-spinner\",loginBtnLabel:\"Logging In...\"});url=\"auth/login?username=\"+_this.emailInputRef.current.value+\"&password=\"+_this.passwordInputRef.current.value;_context.next=5;return fetch(url,{method:'POST'});case 5:res=_context.sent;if(!(res.status==200)){_context.next=10;break;}//successful login!\nwindow.open(\"/\",\"_self\");_context.next=14;break;case 10:_context.next=12;return res.text();case 12:resText=_context.sent;_this.setState({loginBtnIcon:\"fa fa-sign-in\",loginBtnLabel:\"Log In\",statusMsg:resText});case 14:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.accountCreateDone=function(msg){_this.setState({statusMsg:msg,showCreateAccountDialog:false});};_this.cancelCreateAccount=function(){_this.setState({showCreateAccountDialog:false});};_this.cancelResetPassword=function(){_this.resetUserId=\"\";_this.resetQ=\"\";_this.resetA=\"\";_this.setState({showLookUpAccountDialog:false,showSecurityQuestionDialog:false,showResetPaswordDialog:false});};_this.handleOAuthLogin=function(provider){window.open(\"/auth/\".concat(provider),\"_self\");};_this.handleOAuthLoginClick=function(provider){var _this$setState;_this.setState((_this$setState={},_defineProperty(_this$setState,provider+\"Icon\",\"fa fa-spin fa-spinner\"),_defineProperty(_this$setState,provider+\"Label\",\"Connecting...\"),_this$setState));setTimeout(function(){return _this.handleOAuthLogin(provider);},1000);};_this.getSecurityAnswer=function(userId,question,answer){_this.resetUserId=userId;_this.resetQ=question;_this.resetA=answer;_this.setState({showLookUpAccountDialog:false,showSecurityQuestionDialog:true});};_this.getNewPassword=function(){_this.setState({showSecurityQuestionDialog:false,showResetPaswordDialog:true});};_this.resetPassword=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(pw){var url,res,resText;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:url=\"/users/\"+_this.resetUserId;_context2.next=3;return fetch(url,{headers:{'Accept':'application/json','Content-Type':'application/json'},method:'PUT',body:JSON.stringify({password:pw})});case 3:res=_context2.sent;if(!(res.status==200)){_context2.next=8;break;}//successful update creation!\n_this.setState({showResetPaswordDialog:false,statusMsg:\"Password successfully reset!\"});_context2.next=12;break;case 8:_context2.next=10;return res.text();case 10:resText=_context2.sent;_this.setState({showResetPasswordDialog:false,statusMsg:resText});case 12:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.accountCreateDone=function(msg,deleted){_this.setState({statusMsg:msg,showCreateAccountDialog:false});};_this.closeStatusMsg=function(){_this.setState({statusMsg:\"\"});};_this.cancelCreateAccount=function(){_this.setState({showCreateAccountDialog:false});};_this.emailInputRef=React.createRef();_this.resetUserId=\"\";_this.resetQ=\"\";_this.resetA=\"\";_this.passwordInputRef=React.createRef();_this.state={statusMsg:\"\",loginBtnIcon:\"fa fa-sign-in\",loginBtnLabel:\"Log In\",showLookUpAccountDialog:false,showSecurityQuestionDialog:false,showResetPaswordDialog:false,githubIcon:\"fa fa-github\",githubLabel:\"Sign in with GitHub\",loginMsg:\"\",newAccountCreated:false,googleIcon:\"fa fa-google\",googleLabel:\"Sign in with Google\"};return _this;}//Focus cursor in email input field when mounted\n_createClass(LoginPage,[{key:\"componentDidMount\",value:function componentDidMount(){this.emailInputRef.current.focus();}//handleLoginSubmit -- Called when user clicks on login button.\n},{key:\"render\",value:function render(){var _this2=this;return React.createElement(\"div\",null,React.createElement(\"center\",null,this.state.statusMsg!=\"\"?React.createElement(\"div\",{className:\"status-msg\"},React.createElement(\"span\",null,this.state.statusMsg),React.createElement(\"button\",{className:\"modal-close\",onClick:this.closeStatusMsg},React.createElement(\"span\",{className:\"fa fa-times\"}))):null,this.state.showLookUpAccountDialog?React.createElement(LookUpAccountDialog,{cancelResetPassword:this.cancelResetPassword,getSecurityAnswer:this.getSecurityAnswer}):null,this.state.showSecurityQuestionDialog?React.createElement(SecurityQuestionDialog,{cancelResetPassword:this.cancelResetPassword,question:this.resetQ,answer:this.resetA,getNewPassword:this.getNewPassword}):null,this.state.showResetPaswordDialog?React.createElement(ResetPasswordDialog,{cancelResetPassword:this.cancelResetPassword,resetPassword:this.resetPassword}):null,React.createElement(\"form\",{id:\"loginInterface\",onSubmit:this.handleLoginSubmit},React.createElement(\"label\",{htmlFor:\"emailInput\",style:{padding:0,fontSize:24}},\"Email:\",React.createElement(\"input\",{ref:this.emailInputRef,className:\"form-control login-text\",type:\"email\",placeholder:\"Enter Email Address\",id:\"emailInput\",pattern:\"[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\\\.[A-Za-z]{2,}\",required:true})),React.createElement(\"p\",null),React.createElement(\"label\",{htmlFor:\"passwordInput\",style:{padding:0,fontSize:24}},\"Password:\",React.createElement(\"input\",{ref:this.passwordInputRef,className:\"form-control login-text\",type:\"password\",id:\"passwordInput\",placeholder:\"Enter Password\",pattern:\"[A-Za-z0-9!@#$%^&*()_+\\\\-]+\",required:true})),React.createElement(\"p\",{className:\"bg-danger\",id:\"feedback\",style:{fontSize:16}}),React.createElement(\"button\",{type:\"submit\",className:\"btn-color-theme btn btn-primary btn-block login-btn\"},React.createElement(\"span\",{id:\"login-btn-icon\",className:this.state.loginBtnIcon}),\"\\xA0\",this.state.loginBtnLabel),React.createElement(\"p\",null,React.createElement(\"button\",{type:\"button\",className:\"btn btn-link login-link\",onClick:function onClick(){_this2.setState({showCreateAccountDialog:true});}},\"Create an account\"),\" |\",React.createElement(\"button\",{type:\"button\",className:\"btn btn-link login-link\",onClick:function onClick(){_this2.setState({showLookUpAccountDialog:true});}},\"Reset your password\")),React.createElement(\"button\",{id:\"github-login-btn\",type:\"button\",className:\"btn btn-github\",onClick:function onClick(){return _this2.handleOAuthLoginClick(\"github\");}},React.createElement(\"span\",{className:this.state.githubIcon}),\"\\xA0\",this.state.githubLabel),React.createElement(\"button\",{id:\"google-login-btn\",type:\"button\",className:\"btn btn-google\",onClick:function onClick(){return _this2.handleOAuthLoginClick(\"google\");}},React.createElement(\"span\",{className:this.state.googleIcon}),\"\\xA0\",this.state.googleLabel),React.createElement(\"p\",null,React.createElement(\"i\",null,\"Version CptS 489\"))),this.state.showCreateAccountDialog?React.createElement(CreateEditAccountDialog,{create:true,done:this.accountCreateDone,cancel:this.cancelCreateAccount}):null,this.state.showResetPasswordDialog?React.createElement(ResetPasswordDialog,null):null));}}]);return LoginPage;}(React.Component);export default LoginPage;","map":{"version":3,"sources":["/Users/puthypor/Desktop/ssplay/SpeedGolfWebsite/client/src/components/LoginPage.js"],"names":["React","CreateEditAccountDialog","ResetPasswordDialog","LookUpAccountDialog","SecurityQuestionDialog","LoginPage","handleLoginSubmit","event","preventDefault","setState","loginBtnIcon","loginBtnLabel","url","emailInputRef","current","value","passwordInputRef","fetch","method","res","status","window","open","text","resText","statusMsg","accountCreateDone","msg","showCreateAccountDialog","cancelCreateAccount","cancelResetPassword","resetUserId","resetQ","resetA","showLookUpAccountDialog","showSecurityQuestionDialog","showResetPaswordDialog","handleOAuthLogin","provider","handleOAuthLoginClick","setTimeout","getSecurityAnswer","userId","question","answer","getNewPassword","resetPassword","pw","headers","body","JSON","stringify","password","showResetPasswordDialog","deleted","closeStatusMsg","createRef","state","githubIcon","githubLabel","loginMsg","newAccountCreated","googleIcon","googleLabel","focus","padding","fontSize","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport CreateEditAccountDialog from './CreateEditAccountDialog.js';\nimport ResetPasswordDialog from './ResetPasswordDialog.js';\nimport LookUpAccountDialog from './LookUpAccountDialog.js';\nimport SecurityQuestionDialog from './SecurityQuestionDialog.js';\n\nclass LoginPage extends React.Component {\n\nconstructor() {\n    super();\n    //Create a ref for the email input DOM element\n    this.emailInputRef = React.createRef();\n    this.resetUserId = \"\";\n    this.resetQ = \"\";\n    this.resetA = \"\";\n    this.passwordInputRef = React.createRef();\n    this.state = {statusMsg: \"\",\n                  loginBtnIcon: \"fa fa-sign-in\",\n                  loginBtnLabel: \"Log In\",\n                  showLookUpAccountDialog: false,\n                  showSecurityQuestionDialog: false,\n                  showResetPaswordDialog: false,\n                  githubIcon: \"fa fa-github\",\n                  githubLabel: \"Sign in with GitHub\",\n                  loginMsg: \"\",\n                  newAccountCreated: false,\n                  googleIcon: \"fa fa-google\",\n                  googleLabel: \"Sign in with Google\"\n                  };\n} \n    \n//Focus cursor in email input field when mounted\ncomponentDidMount() {\n    this.emailInputRef.current.focus();\n}  \n\n//handleLoginSubmit -- Called when user clicks on login button.\nhandleLoginSubmit = async (event) => {\n    event.preventDefault();\n    this.setState({loginBtnIcon: \"fa fa-spin fa-spinner\",\n                   loginBtnLabel: \"Logging In...\"});\n    const url = \"auth/login?username=\" + this.emailInputRef.current.value +\n                \"&password=\" + this.passwordInputRef.current.value;\n    const res = await fetch(url, {method: 'POST'}); \n    if (res.status == 200) { //successful login!\n        window.open(\"/\",\"_self\");\n    } else { //Unsuccessful login\n      const resText = await res.text();\n      this.setState({loginBtnIcon: \"fa fa-sign-in\",\n                     loginBtnLabel: \"Log In\",\n                     statusMsg: resText});\n    }\n}\n\n  //accountCreateDone -- Called by child CreateAccountDialog component when \n  //user attempted to create new account. Hide the dialog and display \n  //a message indicating result of the attempt.\n  accountCreateDone = (msg) => {\n      this.setState({statusMsg: msg,\n                     showCreateAccountDialog: false});\n  }\n\n  //cancelCreateAccount -- Called by child CreateAccountDialog componenet when user decides\n  //to cancel creation of new account by clicking the \"X\" in top-right of dialog.\n  cancelCreateAccount = () => {\n      this.setState({showCreateAccountDialog: false});\n  }\n\n//cancelResetPassword -- Called by one of the child three child dialog box components when\n//the user decides to cancel resetting their password. Toggles state so that all three\n//of the dialog boxes are hidden\ncancelResetPassword = () => {\n    this.resetUserId = \"\";\n    this.resetQ = \"\";\n    this.resetA = \"\";\n    this.setState({showLookUpAccountDialog: false,\n                   showSecurityQuestionDialog: false,\n                   showResetPaswordDialog: false});             \n}\n\n//handleOAuthLogin -- Callback function that initiates contact with OAuth\n//provider\nhandleOAuthLogin = (provider) => {\n    window.open(`/auth/${provider}`,\"_self\");\n}\n\n//handleOAuthLoginClick -- Called whent the user clicks on button to\n//authenticate via a third-party OAuth service. The name of the provider is\n//passed in as a parameter.\nhandleOAuthLoginClick = (provider) => {\n   this.setState({[provider + \"Icon\"] : \"fa fa-spin fa-spinner\",\n                  [provider + \"Label\"] : \"Connecting...\"});\n   setTimeout(() => this.handleOAuthLogin(provider),1000);\n}\n\n//getSecurityAnswer: Given the id, security question, and security answer obtained\n//from the LookUpAccountDialog component, update state such that the user will\n//next be prompted to enter security question and answer for verification\ngetSecurityAnswer = (userId, question, answer) => {\n    this.resetUserId = userId;\n    this.resetQ = question;\n    this.resetA = answer;\n    this.setState({showLookUpAccountDialog: false,\n                   showSecurityQuestionDialog: true\n                });\n}\n\n//getNewPassword-- Called after user successfully provides correct answer\n//to security question. Presents the \"Reset Password\" dialog box.\ngetNewPassword = () => {\n    this.setState({showSecurityQuestionDialog: false,\n                    showResetPaswordDialog: true});\n}\n\n//resetPassword--Called after the user successfully enters a new (acceptable)\n//password. pw contains the new password. Call on the Update (PUT) server\n//route to update the user's password in the database.\nresetPassword = async(pw) => {\n    const url = \"/users/\" + this.resetUserId;\n    const res = await fetch(url, {\n        headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n            },\n        method: 'PUT',\n        body: JSON.stringify({password: pw})}); \n    if (res.status == 200) { //successful update creation!\n        this.setState({showResetPaswordDialog: false,\n                       statusMsg: \"Password successfully reset!\"});\n    } else { //Unsuccessful account creation\n        //Grab textual error message\n        const resText = await res.text();\n        this.setState({showResetPasswordDialog: false,\n                      statusMsg: resText});\n    }\n    \n}\n\n//newAccountCreated -- Called after successful creation of a new account\naccountCreateDone = (msg,deleted) => {\n    this.setState({statusMsg: msg,\n                   showCreateAccountDialog: false});\n}\n\n//closeStatusMsg -- Called when user clicks on \"x\" to dismiss status message\ncloseStatusMsg = () => {\n    this.setState({statusMsg: \"\"});\n}\n\n//cancelCreateAccount -- called to hide Create Account dialog without creating acct\ncancelCreateAccount = () => {\n    this.setState({showCreateAccountDialog: false});\n}\n\n  render() {\n    return(\n        <div>\n        <center>\n        {this.state.statusMsg != \"\" ? <div className=\"status-msg\"><span>{this.state.statusMsg}</span>\n                       <button className=\"modal-close\" onClick={this.closeStatusMsg}>\n                          <span className=\"fa fa-times\"></span>\n                        </button></div>: null}\n            {this.state.showLookUpAccountDialog ? \n              <LookUpAccountDialog cancelResetPassword={this.cancelResetPassword}\n                                   getSecurityAnswer={this.getSecurityAnswer}/> : null}\n            {this.state.showSecurityQuestionDialog ? \n               <SecurityQuestionDialog cancelResetPassword={this.cancelResetPassword}\n                                       question={this.resetQ}\n                                       answer={this.resetA}\n                                       getNewPassword={this.getNewPassword}/> : null}\n            {this.state.showResetPaswordDialog ? \n              <ResetPasswordDialog cancelResetPassword={this.cancelResetPassword}\n                                   resetPassword={this.resetPassword} /> : null}\n            <form id=\"loginInterface\" onSubmit={this.handleLoginSubmit}>\n            <label htmlFor=\"emailInput\" style={{ padding: 0, fontSize: 24 }}>\n                Email:\n                <input\n                ref={this.emailInputRef}\n                className=\"form-control login-text\"\n                type=\"email\"\n                placeholder=\"Enter Email Address\"\n                id=\"emailInput\"\n                pattern=\"[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}\"\n                required={true}\n                />\n            </label>\n            <p />\n            <label htmlFor=\"passwordInput\" style={{ padding: 0, fontSize: 24 }}>\n                Password:\n                <input\n                ref={this.passwordInputRef}\n                className=\"form-control login-text\"\n                type=\"password\"\n                id=\"passwordInput\"\n                placeholder=\"Enter Password\"\n                pattern=\"[A-Za-z0-9!@#$%^&*()_+\\-]+\"\n                required={true}\n                />\n            </label>\n            <p className=\"bg-danger\" id=\"feedback\" style={{ fontSize: 16 }} />\n            <button\n                type=\"submit\"\n                className=\"btn-color-theme btn btn-primary btn-block login-btn\">\n                <span id=\"login-btn-icon\" className={this.state.loginBtnIcon}/>\n                &nbsp;{this.state.loginBtnLabel}\n            </button>\n            <p>\n            <button type=\"button\" className=\"btn btn-link login-link\" \n                    onClick={() => {this.setState({showCreateAccountDialog: true});}}>\n                Create an account</button> | \n                <button type=\"button\" className=\"btn btn-link login-link\"\n                        onClick={() => {this.setState({showLookUpAccountDialog: true});}}>\n                Reset your password</button>\n            </p>  \n            <button id=\"github-login-btn\" type=\"button\" className=\"btn btn-github\"\n               onClick={() => this.handleOAuthLoginClick(\"github\")}>\n              <span className={this.state.githubIcon}></span>&nbsp;\n                {this.state.githubLabel}\n            </button>\n            <button id=\"google-login-btn\" type=\"button\" className=\"btn btn-google\"\n               onClick={() => this.handleOAuthLoginClick(\"google\")}>\n              <span className={this.state.googleIcon}></span>&nbsp;\n                {this.state.googleLabel}\n            </button>\n            <p>\n                <i>Version CptS 489</i>\n            </p>\n            </form>\n            {this.state.showCreateAccountDialog ? \n              <CreateEditAccountDialog\n                create={true} \n                done={this.accountCreateDone}\n                cancel={this.cancelCreateAccount} /> : null}\n            {this.state.showResetPasswordDialog ? <ResetPasswordDialog /> : null}\n        </center>\n        </div>\n        )\n    }\n} \n\nexport default LoginPage;\n"]},"metadata":{},"sourceType":"module"}